<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Filter extends CI_Controller {    function __construct() {        parent::__construct();        $this->config->load('ad_config');        $this->log_in_link = $this->config->item('link_login');    }    function index() {        //  $this->output->cache(99999);        $login = $this->session->userdata('logged');        if ($login) {            return redirect($this->config->item('link_default'));        }        $this->load->view('admin/loginform');    }    function submit() {        $this->load->model('user_model', 'user_m');        $this->load->library('form_validation');        $this->form_validation->set_rules($this->user_m->log_in_validate);        if ($this->form_validation->run() === FALSE) {            redirect($this->log_in_link);        }        $username = $this->input->post('username');        $password = $this->input->post('password');        $user = $this->user_m->login($username, $password);        if ($user === User_model::LOGIN_FAIL) {            redirect($this->log_in_link);        }        $this->session->set_userdata('logged', $user);        redirect($this->config->item('link_default'));    }    function logout() {        $this->session->unset_userdata('logged');        redirect($this->log_in_link);    }}