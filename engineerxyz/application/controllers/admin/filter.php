<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Filter extends CI_Controller {    function index() {        //  $this->output->cache(99999);        $login = $this->session->userdata('admin');        if ($login) {            return redirect('admin/admin');        }        $this->load->view('admin/loginform');    }    function submit() {        $this->load->library('form_validation');        $this->form_validation->set_rules('username', 'Tên đăng nhập', 'required');        $this->form_validation->set_rules('password', 'Mật khẩu', 'required');        if ($this->form_validation->run() === FALSE) {            redirect('admin/filter');        } else {            $this->load->model('admin_model');            $username = $this->input->post('username');            $ret = $this->admin_model->login($username, $this->input->post('password'));            if ($ret === Admin_model::LOGIN_FAIL) {                redirect('admin/filter');                exit;            } else {                session_start();                $_SESSION['role'] = $ret; //$this->admin_model->getRoleName($ret);                $this->session->set_userdata('admin', $username);                redirect('admin/admin');                exit;            }        }    }    function logout() {        $this->session->unset_userdata('admin');        unset($_SESSION['role']);        redirect('admin/filter');    }}